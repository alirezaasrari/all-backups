using Terminal.Dictionaries;
using Terminal.Tools;
using Terminal.Model;
using Terminal.Context;
using System.Text.Json;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.DependencyInjection;

namespace Terminal.Convertors
{
    public static class PacketDataAnalizer
    {
        public static string DataAnalizer(string data, string Code,string dataloggerserial)
        {
            int valid = SerialNumberCheck.SerialCheck(dataloggerserial);
            var services = new ServiceCollection();
            // this is the connection string for communication with the database
            var connectionString = "server=185.7.212.184;port=3306;database=talayieh-test;user=root;password=1372328$oheiL!@#$!;";
            // in this part we prepare for using entity framework core context as a connectin bridge with the table and models
            services.AddDbContext<DataContext>(options => options.UseMySql(connectionString, ServerVersion.AutoDetect(connectionString)));
            var serviceProvider = services.BuildServiceProvider();
            using var scope = serviceProvider.CreateScope();
            var db = scope.ServiceProvider.GetService<DataContext>();  
            if (data == null)
            {
                return "بدون اطلاعات";
            }
            else
            {   
                if (data.Length == 28 && Code == "40")                
                {             
                    return $"شناسه یکتا:{HexToDecimalConvertor.HexToDecimal(data[..4])}," +
                        $" شماره سریال کنتور:{HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8))} ," +
                        $" مصرف فعلی:{HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)) / 10} لیتر," +
                        $" زمان تخلیه اطلاعات:{HexDateConverter.ConvertHexToDate(data.Substring(20, 8))} ,";
                }
                else if (Code == "46" || Code == "48" || Code == "49")
                {
                    var len = data.Length;
                    return $"شناسه یکتا:{HexToDecimalConvertor.HexToDecimal(data[..4])}," +
                        $" اطلاعات:{StringToHex.ToHexString(data.Substring(4, len - 4))}";
                }
                else if (Code == "4a" || Code == "4A" || Code == "4b" || Code == "4B")
                {
                    return $"شناسه یکتا:{HexToDecimalConvertor.HexToDecimal(data[..4])}";
                }
                else if (Code == "4c" || Code == "4C")
                {
                    return $"شناسه یکتا:{HexToDecimalConvertor.HexToDecimal(data[..4])}," +
                        $" کد خطا:{HexToDecimalConvertor.HexToDecimal(data.Substring(4, 2))}";
                }
                else if (data.Length == 12)
                {
                    return $"شناسه یکتا:{HexToDecimalConvertor.HexToDecimal(data[..4])} ," +
                        $"شارژ سیمکارت به ریال:{HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8))} ,";
                }
                else if (data.Length == 28 && Code == "42")   
                {                  
                    if (valid == 1)           
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                List<WaterMeterDailyUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(20, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "42"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(), 
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }                       
                    }
                    // this is the data for daily usage and one meter
                    return "";
                }
                else if (data.Length == 28 && Code == "43")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterMounthlyUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(20, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "43"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for mounth and one meter
                    return "";
                }
                else if (data.Length == 44 && Code == "44")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(37, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "44"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for total usage and one meter
                    return "";
                }
                else if (data.Length == 18 && Code == "A6" || data.Length == 18 && Code == "a6")
                {                  
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/alarms";

                                AlarmModel requestData =
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data[..8]).ToString() == dataloggerserial? null : HexToDecimalConvertor.HexToDecimal(data[..8]).ToString(),
                                        Fk_AlarmTypeCode = data.Substring(16, 2),
                                        Fk_DataLoggerSerial = dataloggerserial,
                                        ActionAt = MiladiToShamsi3.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(8, 8)))
                                    };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for alarm of one meter
                    return $"سریال کنتور:{HexToDecimalConvertor.HexToDecimal(data[..4])} ," +
                        $" زمان تخلیه اطلاعات:{HexDateConverter.ConvertHexToDate(data.Substring(8, 8))} ," +
                        $" خطا:{CommandManager.GetCommandDescription(data.Substring(16, 2))} ,";
                }              
                else if (data.Length == 116 && Code == "41")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(12, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 4)) }
                                        },
                                        CommandCode = "41"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for horly usage and one meter
                    return "";
                }
                else if (data.Length == 34 && Code == "A0" || data.Length == 34 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and one meter 
                    return "";
                }
                else if (data.Length == 66 && Code == "A0" || data.Length == 66 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this the data for midnight and two meter 
                    return "";
                }
                else if (data.Length == 98 && Code == "A0" || data.Length == 98 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and three meter
                    return "";
                }
                else if (data.Length == 130 && Code == "A0" || data.Length == 130 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and four meter
                    return "";
                }
                else if (data.Length == 162 && Code == "A0" || data.Length == 162 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and five meter
                    return "";
                }
                else if (data.Length == 194 && Code == "A0" || data.Length == 194 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and six meter
                    return "";
                }
                else if (data.Length == 226 && Code == "A0" || data.Length == 226 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and seven meter
                    return "";
                }
                else if (data.Length == 258 && Code == "A0" || data.Length == 258 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 290 && Code == "A0" || data.Length == 290 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 322 && Code == "A0" || data.Length == 322 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 354 && Code == "A0" || data.Length == 354 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 386 && Code == "A0" || data.Length == 386 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 418 && Code == "A0" || data.Length == 418 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 450 && Code == "A0" || data.Length == 450 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 482 && Code == "A0" || data.Length == 482 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 514 && Code == "A0" || data.Length == 514 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 546 && Code == "A0" || data.Length == 546 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(514, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(538, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 578 && Code == "A0" || data.Length == 578 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(514, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(538, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(546, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 610 && Code == "A0" || data.Length == 610 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(514, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(538, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(546, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(578, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(602, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 642 && Code == "A0" || data.Length == 642 && Code == "a0")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(58, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(514, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(538, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(546, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(578, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(602, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 8)),
                                        CommandCode = "A0"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(610, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(634, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 8)),
                                        CommandCode = "A0"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 34 && Code == "A2" || data.Length == 34 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for month and one meter 
                    return "";
                }
                else if (data.Length == 66 && Code == "A2" || data.Length == 66 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this the data for month and two meter 
                    return "";
                }
                else if (data.Length == 98 && Code == "A2" || data.Length == 98 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for month and three meter
                    return "";
                }
                else if (data.Length == 130 && Code == "A2" || data.Length == 130 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for month and four meter
                    return "";
                }
                else if (data.Length == 162 && Code == "A2" || data.Length == 162 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for month and five meter
                    return "";
                }
                else if (data.Length == 194 && Code == "A2" || data.Length == 194 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for month and six meter
                    return "";
                }
                else if (data.Length == 226 && Code == "A2" || data.Length == 226 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for month and seven meter
                    return "";
                }
                else if (data.Length == 258 && Code == "A2" || data.Length == 258 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for month and eight meter
                    return "";
                }
                else if (data.Length == 290 && Code == "A2" || data.Length == 290 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 322 && Code == "A2" || data.Length == 322 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 354 && Code == "A2" || data.Length == 354 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 386 && Code == "A2" || data.Length == 386 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 418 && Code == "A2" || data.Length == 418 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and 13 meter
                    return "";
                }
                else if (data.Length == 450 && Code == "A2" || data.Length == 450 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and 14 meter
                    return "";
                }
                else if (data.Length == 482 && Code == "A2" || data.Length == 482 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(458, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and 15 meter
                    return "";
                }
                else if (data.Length == 514 && Code == "A2" || data.Length == 514 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(458, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and 16 meter
                    return "";
                }
                else if (data.Length == 546 && Code == "A2" || data.Length == 546 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(458, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(514, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(538, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and 17 meter
                    return "";
                }
                else if (data.Length == 578 && Code == "A2" || data.Length == 578 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(458, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(514, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(538, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(546, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 610 && Code == "A2" || data.Length == 610 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(458, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(514, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(538, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(546, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(578, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(602, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 642 && Code == "A2" || data.Length == 642 && Code == "a2")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(26, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(34, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(42, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(10, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(66, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(88, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(98, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(154, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(186, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(194, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(218, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(250, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(234, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(258, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(282, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(290, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(314, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(322, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(354, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(378, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(386, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(410, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(418, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(442, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(474, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(458, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(482, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(506, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(514, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(538, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(546, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(578, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(602, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 8)),
                                        CommandCode = "a2"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(610, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(634, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 8)),
                                        CommandCode = "a2"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for midnight and eight meter
                    return "";
                }
                else if (data.Length == 114 && Code == "a1" || data.Length == 114 && Code == "A1" || data.Length == 114 && Code == "A4" || data.Length == 114 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);
                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";
                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    }
                                };
                                
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and one meter
                    // also this state can describe queue data for hourly profile of one meter
                    return "";
                }
                else if (data.Length == 226 && Code == "a1" || data.Length == 226 && Code == "A1" || data.Length == 226 && Code == "A4" || data.Length == 226 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and two meter
                    // also this state can describe queue data for hourly profile of two meter
                    return "";
                }
                else if (data.Length == 338 && Code == "a1" || data.Length == 338 && Code == "A1" || data.Length == 338 && Code == "A4" || data.Length == 338 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },
                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and three meter
                    // also this state can describe queue data for hourly profile of three meter
                    return "";
                }
                else if (data.Length == 450 && Code == "a1" || data.Length == 450 && Code == "A1" || data.Length == 450 && Code == "A4" || data.Length == 450 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },    
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and four meter
                    // also this state can describe queue data for hourly profile of four meter
                    return "";
                }
                else if (data.Length == 562 && Code == "a1" || data.Length == 562 && Code == "A1" || data.Length == 562 && Code == "A4" || data.Length == 562 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and five meter
                    // also this state can describe queue data for hourly profile of five meter
                    return "";
                }
                else if (data.Length == 674 && Code == "a1" || data.Length == 674 && Code == "A1" || data.Length == 674 && Code == "A4" || data.Length == 674 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and six meter
                    // also this state can describe queue data for hourly profile of six meter
                    return "";
                }
                else if (data.Length == 786 && Code == "a1" || data.Length == 786 && Code == "A1" || data.Length == 786 && Code == "A4" || data.Length == 786 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                            UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                            CommandCode = "a4"
                                        }
                                    };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and seven meter
                    // also this state can describe queue data for hourly profile of seven meter
                    return "";
                }
                else if (data.Length == 898 && Code == "a1" || data.Length == 898 && Code == "A1" || data.Length == 898 && Code == "A4" || data.Length == 898 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and eight meter
                    // also this state can describe queue data for hourly profile of eight meter
                    return "";
                }
                else if (data.Length == 1010 && Code == "a1" || data.Length == 1010 && Code == "A1" || data.Length == 1010 && Code == "A4" || data.Length == 1010 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 9 meter
                    // also this state can describe queue data for hourly profile of 9 meter
                    return "";
                }
                else if (data.Length == 1122 && Code == "a1" || data.Length == 1122 && Code == "A1" || data.Length == 1122 && Code == "A4" || data.Length == 1122 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 10 meter
                    // also this state can describe queue data for hourly profile of 10 meter
                    return "";
                }
                else if (data.Length == 1234 && Code == "a1" || data.Length == 1234 && Code == "A1" || data.Length == 1234 && Code == "A4" || data.Length == 1234 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 11 meter
                    // also this state can describe queue data for hourly profile of 11 meter
                    return "";
                }
                else if (data.Length == 1346 && Code == "a1" || data.Length == 1346 && Code == "A1" || data.Length == 1346 && Code == "A4" || data.Length == 1346 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 12 meter
                    // also this state can describe queue data for hourly profile of 12 meter
                    return "";
                }
                else if (data.Length == 1458 && Code == "a1" || data.Length == 1458 && Code == "A1" || data.Length == 1458 && Code == "A4" || data.Length == 1458 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1346, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1354, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1362, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1366, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1370, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1374, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1378, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1382, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1386, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1390, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1394, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1398, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1402, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1406, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1410, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1414, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1418, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1422, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1426, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1430, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1434, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1438, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1442, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1446, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1450, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1454, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 13 meter
                    // also this state can describe queue data for hourly profile of 13 meter
                    return "";
                }
                else if (data.Length == 1570 && Code == "a1" || data.Length == 1570 && Code == "A1" || data.Length == 1570 && Code == "A4" || data.Length == 1570 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1346, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1354, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1362, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1366, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1370, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1374, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1378, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1382, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1386, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1390, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1394, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1398, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1402, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1406, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1410, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1414, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1418, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1422, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1426, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1430, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1434, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1438, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1442, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1446, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1450, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1454, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1458, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1466, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1474, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1478, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1482, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1486, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1490, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1494, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1498, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1502, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1506, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1510, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1514, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1518, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1522, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1526, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1530, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1534, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1538, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1542, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1546, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1550, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1554, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1558, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1562, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1566, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 14 meter
                    // also this state can describe queue data for hourly profile of 14 meter
                    return "";
                }
                else if (data.Length == 1682 && Code == "a1" || data.Length == 1682 && Code == "A1" || data.Length == 1682 && Code == "A4" || data.Length == 1682 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1346, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1354, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1362, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1366, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1370, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1374, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1378, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1382, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1386, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1390, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1394, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1398, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1402, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1406, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1410, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1414, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1418, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1422, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1426, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1430, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1434, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1438, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1442, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1446, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1450, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1454, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1458, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1466, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1474, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1478, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1482, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1486, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1490, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1494, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1498, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1502, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1506, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1510, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1514, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1518, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1522, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1526, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1530, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1534, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1538, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1542, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1546, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1550, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1554, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1558, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1562, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1566, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1570, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1578, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1586, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1590, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1594, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1598, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1602, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1606, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1610, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1614, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1618, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1622, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1626, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1630, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1634, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1638, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1642, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1646, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1650, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1654, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1658, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1662, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1666, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1670, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1674, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1678, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 15 meter
                    // also this state can describe queue data for hourly profile of 15 meter
                    return "";
                }
                else if (data.Length == 1794 && Code == "a1" || data.Length == 1794 && Code == "A1" || data.Length == 1794 && Code == "A4" || data.Length == 1794 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1346, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1354, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1362, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1366, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1370, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1374, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1378, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1382, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1386, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1390, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1394, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1398, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1402, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1406, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1410, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1414, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1418, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1422, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1426, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1430, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1434, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1438, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1442, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1446, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1450, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1454, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1458, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1466, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1474, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1478, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1482, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1486, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1490, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1494, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1498, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1502, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1506, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1510, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1514, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1518, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1522, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1526, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1530, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1534, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1538, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1542, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1546, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1550, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1554, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1558, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1562, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1566, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1570, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1578, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1586, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1590, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1594, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1598, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1602, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1606, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1610, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1614, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1618, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1622, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1626, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1630, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1634, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1638, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1642, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1646, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1650, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1654, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1658, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1662, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1666, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1670, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1674, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1678, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1682, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1690, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1698, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1702, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1706, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1710, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1714, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1718, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1722, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1726, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1730, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1734, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1738, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1742, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1746, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1750, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1754, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1758, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1762, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1766, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1770, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1774, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1778, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1782, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1786, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1790, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 16 meter
                    // also this state can describe queue data for hourly profile of 16 meter
                    return "";
                }
                else if (data.Length == 1906 && Code == "a1" || data.Length == 1906 && Code == "A1" || data.Length == 1906 && Code == "A4" || data.Length == 1906 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1346, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1354, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1362, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1366, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1370, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1374, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1378, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1382, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1386, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1390, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1394, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1398, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1402, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1406, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1410, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1414, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1418, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1422, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1426, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1430, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1434, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1438, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1442, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1446, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1450, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1454, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1458, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1466, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1474, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1478, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1482, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1486, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1490, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1494, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1498, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1502, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1506, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1510, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1514, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1518, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1522, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1526, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1530, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1534, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1538, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1542, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1546, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1550, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1554, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1558, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1562, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1566, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1570, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1578, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1586, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1590, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1594, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1598, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1602, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1606, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1610, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1614, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1618, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1622, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1626, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1630, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1634, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1638, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1642, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1646, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1650, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1654, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1658, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1662, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1666, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1670, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1674, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1678, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1682, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1690, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1698, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1702, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1706, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1710, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1714, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1718, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1722, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1726, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1730, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1734, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1738, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1742, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1746, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1750, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1754, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1758, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1762, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1766, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1770, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1774, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1778, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1782, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1786, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1790, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1794, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1802, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1810, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1814, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1818, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1822, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1826, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1830, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1834, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1838, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1842, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1846, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1850, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1854, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1858, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1862, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1866, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1870, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1874, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1878, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1882, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1886, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1890, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1894, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1898, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1902, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 17 meter
                    // also this state can describe queue data for hourly profile of 17 meter
                    return "";
                }
                else if (data.Length == 2018 && Code == "a1" || data.Length == 2018 && Code == "A1" || data.Length == 2018 && Code == "A4" || data.Length == 2018 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1346, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1354, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1362, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1366, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1370, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1374, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1378, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1382, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1386, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1390, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1394, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1398, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1402, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1406, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1410, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1414, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1418, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1422, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1426, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1430, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1434, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1438, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1442, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1446, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1450, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1454, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1458, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1466, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1474, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1478, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1482, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1486, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1490, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1494, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1498, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1502, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1506, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1510, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1514, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1518, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1522, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1526, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1530, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1534, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1538, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1542, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1546, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1550, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1554, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1558, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1562, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1566, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1570, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1578, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1586, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1590, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1594, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1598, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1602, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1606, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1610, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1614, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1618, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1622, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1626, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1630, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1634, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1638, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1642, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1646, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1650, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1654, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1658, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1662, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1666, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1670, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1674, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1678, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1682, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1690, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1698, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1702, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1706, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1710, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1714, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1718, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1722, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1726, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1730, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1734, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1738, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1742, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1746, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1750, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1754, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1758, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1762, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1766, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1770, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1774, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1778, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1782, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1786, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1790, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1794, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1802, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1810, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1814, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1818, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1822, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1826, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1830, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1834, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1838, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1842, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1846, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1850, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1854, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1858, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1862, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1866, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1870, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1874, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1878, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1882, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1886, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1890, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1894, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1898, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1902, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1906, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1914, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1922, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1926, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1930, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1934, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1938, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1942, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1946, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1950, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1954, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1958, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1962, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1966, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1970, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1974, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1978, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1982, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1986, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1990, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1994, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1998, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2002, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2006, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2010, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2014, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 18 meter
                    // also this state can describe queue data for hourly profile of 18 meter
                    return "";
                }
                else if (data.Length == 2130 && Code == "a1" || data.Length == 2130 && Code == "A1" || data.Length == 2130 && Code == "A4" || data.Length == 2130 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1346, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1354, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1362, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1366, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1370, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1374, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1378, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1382, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1386, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1390, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1394, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1398, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1402, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1406, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1410, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1414, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1418, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1422, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1426, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1430, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1434, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1438, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1442, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1446, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1450, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1454, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1458, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1466, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1474, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1478, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1482, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1486, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1490, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1494, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1498, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1502, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1506, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1510, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1514, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1518, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1522, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1526, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1530, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1534, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1538, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1542, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1546, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1550, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1554, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1558, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1562, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1566, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1570, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1578, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1586, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1590, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1594, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1598, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1602, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1606, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1610, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1614, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1618, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1622, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1626, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1630, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1634, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1638, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1642, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1646, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1650, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1654, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1658, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1662, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1666, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1670, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1674, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1678, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1682, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1690, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1698, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1702, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1706, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1710, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1714, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1718, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1722, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1726, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1730, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1734, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1738, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1742, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1746, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1750, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1754, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1758, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1762, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1766, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1770, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1774, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1778, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1782, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1786, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1790, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1794, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1802, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1810, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1814, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1818, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1822, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1826, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1830, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1834, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1838, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1842, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1846, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1850, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1854, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1858, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1862, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1866, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1870, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1874, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1878, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1882, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1886, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1890, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1894, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1898, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1902, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1906, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1914, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1922, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1926, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1930, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1934, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1938, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1942, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1946, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1950, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1954, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1958, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1962, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1966, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1970, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1974, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1978, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1982, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1986, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1990, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1994, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1998, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2002, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2006, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2010, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2014, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2018, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(2026, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2034, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2038, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2042, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2046, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2050, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2054, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2058, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2062, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2066, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2070, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2074, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2078, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2082, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2086, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2090, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2094, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2098, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2102, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2106, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2110, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2114, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2118, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2122, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2126, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 19 meter
                    // also this state can describe queue data for hourly profile of 19 meter
                    return "";
                }
                else if (data.Length == 2242 && Code == "a1" || data.Length == 2242 && Code == "A1" || data.Length == 2242 && Code == "A4" || data.Length == 2242 && Code == "a4")
                {
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/hourly";

                                List<WaterMeterHourlyData> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(10, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(18, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(22, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(26, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(30, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(34, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(38, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(42, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(46, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(50, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(54, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(58, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(62, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(66, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(70, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(74, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(78, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(82, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(86, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(90, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(94, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(98, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(102, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(106, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(110, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(114, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(122, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(130, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(134, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(138, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(142, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(146, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(150, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(154, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(158, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(166, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(174, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(178, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(182, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(186, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(190, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(194, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(198, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(202, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(206, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(210, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(214, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(218, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(222, 4)) }
                                        },
                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(226, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(234, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(242, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(246, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(250, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(254, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(258, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(262, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(266, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(270, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(274, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(278, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(282, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(286, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(290, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(294, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(298, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(302, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(306, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(310, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(314, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(318, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(322, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(326, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(330, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(334, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(338, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(346, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(354, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(358, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(362, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(366, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(370, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(374, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(378, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(382, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(386, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(390, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(394, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(398, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(402, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(406, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(410, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(414, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(418, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(422, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(426, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(430, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(434, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(438, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(442, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(446, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(450, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(458, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(466, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(470, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(474, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(478, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(482, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(486, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(490, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(494, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(498, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(502, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(506, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(510, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(514, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(518, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(522, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(526, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(530, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(534, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(538, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(542, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(546, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(550, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(554, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(558, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(562, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(570, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(578, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(582, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(586, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(590, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(594, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(598, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(602, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(606, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(610, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(614, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(618, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(622, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(626, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(630, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(634, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(638, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(642, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(646, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(650, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(654, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(658, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(662, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(666, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(670, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(674, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(682, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(690, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(694, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(698, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(702, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(706, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(710, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(714, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(718, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(722, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(726, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(730, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(734, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(738, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(742, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(746, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(750, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(754, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(758, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(762, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(766, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(770, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(774, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(778, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(782, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(786, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(794, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(802, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(806, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(810, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(814, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(818, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(822, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(826, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(830, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(834, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(838, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(842, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(846, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(850, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(854, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(858, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(862, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(866, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(870, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(874, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(878, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(882, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(886, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(890, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(894, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(898, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(906, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(914, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(918, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(922, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(926, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(930, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(934, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(938, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(942, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(946, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(950, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(954, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(958, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(962, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(966, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(970, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(974, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(978, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(982, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(986, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(990, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(994, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(998, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1002, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1006, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1010, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1018, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1026, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1030, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1034, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1038, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1042, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1046, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1050, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1054, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1058, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1062, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1066, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1070, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1074, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1078, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1082, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1086, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1090, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1094, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1098, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1102, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1106, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1110, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1114, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1118, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1122, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1130, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1138, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1142, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1146, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1150, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1154, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1158, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1162, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1166, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1170, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1174, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1178, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1182, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1186, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1190, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1194, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1198, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1202, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1206, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1210, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1214, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1218, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1222, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1226, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1230, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1234, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1242, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1250, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1254, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1258, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1262, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1266, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1270, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1274, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1278, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1282, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1286, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1290, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1294, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1298, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1302, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1306, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1310, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1314, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1318, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1322, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1326, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1330, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1334, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1338, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1342, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1346, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1354, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1362, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1366, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1370, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1374, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1378, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1382, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1386, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1390, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1394, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1398, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1402, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1406, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1410, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1414, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1418, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1422, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1426, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1430, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1434, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1438, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1442, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1446, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1450, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1454, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1458, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1466, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1474, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1478, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1482, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1486, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1490, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1494, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1498, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1502, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1506, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1510, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1514, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1518, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1522, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1526, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1530, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1534, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1538, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1542, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1546, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1550, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1554, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1558, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1562, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1566, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1570, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1578, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1586, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1590, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1594, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1598, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1602, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1606, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1610, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1614, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1618, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1622, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1626, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1630, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1634, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1638, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1642, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1646, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1650, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1654, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1658, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1662, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1666, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1670, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1674, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1678, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1682, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1690, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1698, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1702, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1706, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1710, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1714, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1718, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1722, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1726, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1730, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1734, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1738, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1742, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1746, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1750, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1754, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1758, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1762, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1766, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1770, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1774, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1778, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1782, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1786, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1790, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1794, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1802, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1810, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1814, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1818, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1822, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1826, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1830, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1834, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1838, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1842, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1846, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1850, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1854, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1858, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1862, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1866, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1870, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1874, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1878, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1882, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1886, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1890, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1894, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1898, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1902, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(1906, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(1914, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1922, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1926, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1930, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1934, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1938, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1942, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1946, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1950, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1954, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1958, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1962, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1966, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1970, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1974, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1978, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1982, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1986, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1990, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1994, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(1998, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2002, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2006, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2010, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2014, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2018, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(2026, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2034, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2038, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2042, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2046, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2050, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2054, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2058, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2062, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2066, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2070, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2074, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2078, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2082, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2086, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2090, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2094, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2098, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2102, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2106, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2110, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2114, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2118, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2122, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2126, 4)) }
                                        },

                                        CommandCode = "a4"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(2130, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(2138, 8))),
                                        UsageList = new Dictionary<string, int>
                                        {
                                         { "0", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2146, 4)) },
                                         { "1", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2150, 4)) },
                                         { "2", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2154, 4)) },
                                         { "3", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2158, 4)) },
                                         { "4", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2162, 4)) },
                                         { "5", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2166, 4)) },
                                         { "6", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2170, 4)) },
                                         { "7", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2174, 4)) },
                                         { "8", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2178, 4)) },
                                         { "9", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2182, 4)) },
                                         { "10", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2186, 4)) },
                                         { "11", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2190, 4)) },
                                         { "12", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2194, 4)) },
                                         { "13", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2198, 4)) },
                                         { "14", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2202, 4)) },
                                         { "15", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2206, 4)) },
                                         { "16", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2210, 4)) },
                                         { "17", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2214, 4)) },
                                         { "18", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2218, 4)) },
                                         { "19", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2222, 4)) },
                                         { "20", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2226, 4)) },
                                         { "21", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2230, 4)) },
                                         { "22", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2234, 4)) },
                                         { "23", (int)HexToDecimalConvertor.HexToDecimal(data.Substring(2238, 4)) }
                                        },

                                        CommandCode = "a4"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                        }
                        catch (Exception ex)
                        {
                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for hourly usage and 20 meter
                    // also this state can describe queue data for hourly profile of 20 meter
                    return "";
                }
                else if (data.Length == 36 && Code == "A3" || data.Length == 36 && Code == "a3")
                {
                    // this is the data for queue and one meter 
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                //requestBody = $"Usages:{requestBody}";
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {                     
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                                
                            }                         
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 68 && Code == "A3" || data.Length == 68 && Code == "a3")
                {
                    // this the data for queue and two meter 
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 100 && Code == "A3" || data.Length == 100 && Code == "a3")
                {
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    // this is the data for queue and three meter                   
                    return "";
                }
                else if (data.Length == 132 && Code == "A3" || data.Length == 132 && Code == "a3")
                {
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 164 && Code == "A3" || data.Length == 164 && Code == "a3")
                {
                    // this is the data for queue and five meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 196 && Code == "A3" || data.Length == 196 && Code == "a3")
                {
                    // this is the data for queue and six meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 228 && Code == "A3" || data.Length == 228 && Code == "a3")
                {
                    // this is the data for queue and seven meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return $"{frequency} " +
                        $"تعداد کنتورها : {HexToDecimalConvertor.HexToDecimal(data.Substring(2, 2))} ," +
                        $"شماره سریال کنتور اول :{HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8))} ," +
                        $"مصرف کل کنتور اول :{HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور اول :{HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور اول :{HexDateConverter.ConvertHexToDate(data.Substring(28, 8))} ," +
                        $"شماره سریال کنتور دوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8))} ," +
                        $"مصرف کل کنتور دوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور دوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور دوم :{HexDateConverter.ConvertHexToDate(data.Substring(60, 8))} ," +
                        $"شماره سریال کنتور سوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8))} ," +
                        $"مصرف کل کنتور سوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور سوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور سوم :{HexDateConverter.ConvertHexToDate(data.Substring(92, 8))} ," +
                        $"شماره سریال کنتور چهارم :{HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8))} ," +
                        $"مصرف کل کنتور چهارم :{HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور چهارم :{HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور چهارم :{HexDateConverter.ConvertHexToDate(data.Substring(124, 8))} ," +
                        $"شماره سریال کنتور پنجم :{HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8))} ," +
                        $"مصرف کل کنتور پنجم :{HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور پنجم :{HexToDecimalConvertor.HexToDecimal(data.Substring(148, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور پنجم :{HexDateConverter.ConvertHexToDate(data.Substring(156, 8))} ," +
                        $"شماره سریال کنتور ششم :{HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8))} ," +
                        $"مصرف کل کنتور ششم :{HexToDecimalConvertor.HexToDecimal(data.Substring(172, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور ششم :{HexToDecimalConvertor.HexToDecimal(data.Substring(180, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور ششم :{HexDateConverter.ConvertHexToDate(data.Substring(188, 8))} ," +
                        $"شماره سریال کنتور هفتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8))} ," +
                        $"مصرف کل کنتور هفتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور هفتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور هفتم :{HexDateConverter.ConvertHexToDate(data.Substring(220, 8))} ,";
                }
                else if (data.Length == 260 && Code == "A3" || data.Length == 260 && Code == "a3")
                {
                    // this is the data for queue and eight meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return $"{frequency} " +
                        $"تعداد کنتورها : {HexToDecimalConvertor.HexToDecimal(data.Substring(2, 2))} ," +
                        $"شماره سریال کنتور اول :{HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8))} ," +
                        $"مصرف کل کنتور اول :{HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور اول :{HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور اول :{HexDateConverter.ConvertHexToDate(data.Substring(28, 8))} ," +
                        $"شماره سریال کنتور دوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8))} ," +
                        $"مصرف کل کنتور دوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور دوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور دوم :{HexDateConverter.ConvertHexToDate(data.Substring(60, 8))} ," +
                        $"شماره سریال کنتور سوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8))} ," +
                        $"مصرف کل کنتور سوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور سوم :{HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور سوم :{HexDateConverter.ConvertHexToDate(data.Substring(92, 8))} ," +
                        $"شماره سریال کنتور چهارم :{HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8))} ," +
                        $"مصرف کل کنتور چهارم :{HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور چهارم :{HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور چهارم :{HexDateConverter.ConvertHexToDate(data.Substring(124, 8))} ," +
                        $"شماره سریال کنتور پنجم :{HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8))} ," +
                        $"مصرف کل کنتور پنجم :{HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور پنجم :{HexToDecimalConvertor.HexToDecimal(data.Substring(148, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور پنجم :{HexDateConverter.ConvertHexToDate(data.Substring(156, 8))} ," +
                        $"شماره سریال کنتور ششم :{HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8))} ," +
                        $"مصرف کل کنتور ششم :{HexToDecimalConvertor.HexToDecimal(data.Substring(172, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور ششم :{HexToDecimalConvertor.HexToDecimal(data.Substring(180, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور ششم :{HexDateConverter.ConvertHexToDate(data.Substring(188, 8))} ," +
                        $"شماره سریال کنتور هفتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8))} ," +
                        $"مصرف کل کنتور هفتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور هفتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور هفتم :{HexDateConverter.ConvertHexToDate(data.Substring(220, 8))} ," +
                        $"شماره سریال کنتور هشتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8))} ," +
                        $"مصرف کل کنتور هشتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)) / 10} لیتر ," +
                        $"مصرف {frequency} کنتور هشتم :{HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)) / 10} لیتر  ," +
                        $"زمان تخلیه اطلاعات کنتور هشتم :{HexDateConverter.ConvertHexToDate(data.Substring(252, 8))} ,";
                }
                else if (data.Length == 292 && Code == "A3" || data.Length == 292 && Code == "a3")
                {
                    // this is the data for queue and 9 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 324 && Code == "A3" || data.Length == 324 && Code == "a3")
                {
                    // this is the data for queue and 10 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 356 && Code == "A3" || data.Length == 356 && Code == "a3")
                {
                    // this is the data for queue and 11 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 388 && Code == "A3" || data.Length == 388 && Code == "a3")
                {
                    // this is the data for queue and 12 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 420 && Code == "A3" || data.Length == 420 && Code == "a3")
                {
                    // this is the data for queue and 13 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(396, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 452 && Code == "A3" || data.Length == 452 && Code == "a3")
                {
                    // this is the data for queue and 14 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(396, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(428, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 484 && Code == "A3" || data.Length == 484 && Code == "a3")
                {
                    // this is the data for queue and 15 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(396, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(428, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(460, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 516 && Code == "A3" || data.Length == 516 && Code == "a3")
                {
                    // this is the data for queue and 16 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(396, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(428, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(460, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(492, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 548 && Code == "A3" || data.Length == 548 && Code == "a3")
                {
                    // this is the data for queue and 17 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(396, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(428, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(460, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(492, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(532, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(523, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    }
                    return "";
                }
                else if (data.Length == 580 && Code == "A3" || data.Length == 580 && Code == "a3")
                {
                    // this is the data for queue and 18 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if(valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(396, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(428, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(460, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(492, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(556, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(532, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(564, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(523, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(564, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    };
                    return "";
                }
                else if (data.Length == 612 && Code == "A3" || data.Length == 612 && Code == "a3")
                {
                    // this is the data for queue and 19 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if(valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(396, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(428, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(460, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(492, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(556, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(580, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(604, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(588, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(532, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(564, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(580, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(604, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(596, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(523, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(564, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(580, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(604, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(596, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    };
                    return "";
                }
                else if (data.Length == 644 && Code == "A3" || data.Length == 644 && Code == "a3")
                {
                    // this is the data for queue and 20 meter
                    string firstTwoDigits = data[..2];
                    bool isMonthly = firstTwoDigits == "00";
                    string frequency = isMonthly ? "ماهانه" : "روزانه";
                    if (valid == 1)
                    {
                        try
                        {
                            Task.Run(async () =>
                            {
                                string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                string apiUrl = "http://api.sahmab.co/manager/terminal/usage/total";

                                List<WaterMeterTotalUsage> requestData = new()
                                {
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(12, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(44, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(76, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(108, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(156, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(140, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(170, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(204, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(236, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(268, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(300, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(332, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(364, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(396, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(428, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(460, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(492, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(556, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(580, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(604, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(588, 8)),
                                        CommandCode = "a3"
                                    },
                                    new()
                                    {
                                        Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(612, 8)).ToString(),
                                        Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(636, 8))),
                                        Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(620, 8)),
                                        CommandCode = "a3"
                                    }
                                };
                                string requestBody = JsonSerializer.Serialize(requestData);
                                apiKey = result.apiKey;
                                string token = result.token;

                                HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                if (response.IsSuccessStatusCode)
                                {
                                    string responseContent = await response.Content.ReadAsStringAsync();
                                }
                                else
                                {
                                    //string responseContent = "sahmab api crash!"; 
                                };
                            }).Wait();
                            if (frequency == "ماهانه")
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/monthly";

                                    List<WaterMeterMounthlyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(532, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(564, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(580, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(604, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(596, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(612, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(636, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(628, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();
                            }
                            else
                            {
                                Task.Run(async () =>
                                {
                                    string apiKey = "wIJ6!JWrM7bH*&Kpm@$CvACoR4Odg&%968fHz";
                                    var result = await AuthenticateMe.CallApiAndReturnCredentials(apiKey);

                                    string apiUrl = "http://api.sahmab.co/manager/terminal/usage/daily";

                                    List<WaterMeterDailyUsage> requestData = new()
                                    {
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(4, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(28, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(20, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(36, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(60, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(52, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(68, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(92, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(84, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(100, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(124, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(132, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(148, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(116, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(164, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(188, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(162, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(196, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(220, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(212, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(228, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(252, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(244, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(260, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(284, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(276, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(292, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(316, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(308, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(324, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(348, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(340, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(356, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(380, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(372, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(388, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(412, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(404, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(420, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(444, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(436, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(452, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(476, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(468, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(484, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(508, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(500, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(516, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(540, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(523, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(548, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(572, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(564, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(580, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(604, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(596, 8)),
                                            CommandCode = "a3"
                                        },
                                        new()
                                        {
                                            Fk_WaterMeterSerial = HexToDecimalConvertor.HexToDecimal(data.Substring(612, 8)).ToString(),
                                            Date = MiladiToShamsi2.ConvertMiladiToshamsi(HexDateConverter.ConvertHexToDate(data.Substring(636, 8))),
                                            Usage = (int)HexToDecimalConvertor.HexToDecimal(data.Substring(628, 8)),
                                            CommandCode = "a3"
                                        }
                                    };
                                    string requestBody = JsonSerializer.Serialize(requestData);
                                    apiKey = result.apiKey;
                                    string token = result.token;

                                    HttpResponseMessage response = await ApiCaller.CallPostApi(apiUrl, requestBody, apiKey, token);

                                    if (response.IsSuccessStatusCode)
                                    {
                                        string responseContent = await response.Content.ReadAsStringAsync();
                                    }
                                    else
                                    {
                                        //string responseContent = "sahmab api crash!"; 
                                    };
                                }).Wait();

                            }
                        }
                        catch (Exception ex)
                        {

                            var error = new Error()
                            {
                                Message = ex.Message,
                                Date = TimeCalculator.ConvertMiladiToshamsi(),
                            };
                            db?.NewTerminalError.Add(error);
                            db?.SaveChanges();
                        }
                    };
                    return "";
                }
                else if (data.Length == 4) 
                {
                    return "بدون اطلاعات";       
                }   
                else
                {
                    return "پکت تعریف نشده";
                }

            }
        }
    }
}
